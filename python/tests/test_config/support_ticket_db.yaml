entities:
  - name: Staff
    type: resource
    rows: 20
    attributes:
      - name: id
        type: pk
      - name: role
        type: resource_type
        generator:
          type: distribution
          formula: DISC(0.2, SRE, 0.5, Tech Support, 0.2, Dev, 0.1, Security)
  - name: Online_Ticket
    type: entity
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: submitter_id
        type: fk
        generator:
          type: foreign_key
          subtype: one_to_many
          formula: UNIF(3, 10)
        ref: Submitter.id
      - name: description
        type: string
        generator:
          type: faker
          method: sentence
      - name: title
        type: string
        generator:
          type: template
          template: ticket_{id}
  - name: Submitter
    rows: 20
    attributes:
      - name: id
        type: pk
      - name: name
        type: string
        generator:
          type: faker
          method: name
      - name: created_at
        type: datetime
        generator:
          type: formula
          expression: MIN(SELECT created_at FROM Online_Ticket WHERE submitter_id = @id) -
            DAYS(RANDOM(30, 365))
  - name: Phone_Call
    type: entity
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: caller_id
        type: fk
        generator:
          type: foreign_key
          subtype: one_to_many
          formula: UNIF(1, 20)
        ref: Submitter.id
      - name: phone_number
        type: string
        generator:
          type: faker
          method: phone_number
      - name: call_type
        type: string
        generator:
          type: distribution
          formula: DISC(0.6, 'Support', 0.3, 'Sales', 0.1, 'Billing')
  - name: Ticket_Task
    type: event
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: online_ticket_id
        type: entity_id
        ref: Online_Ticket.id
        generator:
          type: foreign_key
          subtype: one_to_many
      - name: event_type
        type: event_type
  - name: Call_Task
    type: event
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: phone_call_id
        type: entity_id
        generator:
          type: foreign_key
          subtype: one_to_many
        ref: Phone_Call.id
      - name: event_type
        type: event_type
  - name: Staff_Task
    type: bridging
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: staff_id
        type: resource_id
        generator:
          type: foreign_key
          subtype: one_to_many
        ref: Staff.id
      - name: ticket_task_id
        type: event_id
        ref: Ticket_Task.id
        generator:
          type: foreign_key
          subtype: one_to_many
      - name: end_date
        type: datetime
      - name: start_date
        type: datetime
  - name: Staff_Call_Task
    type: bridging
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: staff_id
        type: resource_id
        generator:
          type: foreign_key
          subtype: one_to_many
        ref: Staff.id
      - name: call_task_id
        type: event_id
        generator:
          type: foreign_key
          subtype: one_to_many
        ref: Call_Task.id
      - name: end_date
        type: datetime
      - name: start_date
        type: datetime
