# Database configuration for hierarchical entity flow testing
# This demonstrates the Project -> Deliverable -> Consultant allocation pattern
# where Projects spawn Deliverables as simulation entities

entities:
  - name: Project
    type: entity
    rows: n/a  # Created dynamically during simulation
    attributes:
      - name: id
        type: pk
      - name: project_name
        type: string
        generator:
          type: faker
          method: company.buzzNoun()
      - name: created_at
        type: datetime

  - name: Deliverable
    type: entity  # Deliverable is also an entity (child of Project)
    rows: n/a  # Created dynamically via trigger spawning
    attributes:
      - name: id
        type: pk
      - name: project_id
        type: entity_id
        ref: Project.id
        generator:
          type: foreign_key
          subtype: one_to_many
      - name: deliverable_name
        type: string
        generator:
          type: faker
          method: commerce.productName()
      - name: priority
        type: string
        generator:
          type: distribution
          formula: DISC(0.3, 'High', 0.5, 'Medium', 0.2, 'Low')
      - name: created_at
        type: datetime
      - name: completed_at
        type: datetime

  - name: Consultant
    type: resource
    rows: 20
    attributes:
      - name: id
        type: pk
      - name: name
        type: string
        generator:
          type: faker
          method: person.fullName()
      - name: resource_type
        type: resource_type
        generator:
          type: distribution
          formula: DISC(0.5, 'Junior', 0.35, 'Senior', 0.15, 'Lead')
      - name: hourly_rate
        type: decimal(10,2)
        generator:
          type: distribution
          formula: UNIF(50, 200)

  - name: Consultant_Deliverable
    type: bridge
    rows: n/a  # Populated by simulation when Consultants are allocated to Deliverables
    attributes:
      - name: id
        type: pk
      - name: deliverable_id
        type: entity_id  # FK to Deliverable (the entity in the simulation flow)
        ref: Deliverable.id
      - name: consultant_id
        type: resource_id
        ref: Consultant.id
      - name: event_type
        type: event_type
      - name: start_date
        type: datetime
      - name: end_date
        type: datetime
